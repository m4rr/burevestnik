# JSON-RPC

1) Коллбек watchdog - проверяешь, хочешь ли что-то сделать в этот момент; если да, то там и делаешь. Если, например, недостаточно времени прошло, ничего не делаешь, ждёшь следующего тика.

→ `{"cmd": "tick", "args": { "ts": 1234 }}`

← `{"result": "ok"}`

2) Коллбек, который дёргается при появлении пира, в параметрах время и уникальный айдишник

→ `{"cmd": "foundPeer", "args": { "peerID": "iPhone Masala", "time": 1597350769.1234234 }}`

← `{"result": "ok"}`

3) Коллбек, который дёргается при исчезновении пира, в параметрах  время и айдишник

→ `{"cmd": "lostPeer", "args": { "peerID": "iPhone Masala", "time": 1597350769.1234234 }}`

← `{"result": "ok"}`

4) Функция отправки байтов пиру, в параметрах айдишник и данные

→ `{"cmd": "sendToPeer", "args": { "peerID": "iPhone Masala", "data": "text message (?)" }}`

← `{"result": "ok"}`

5) Коллбек, который дёргается при поступлении сообщения от пира, в параметрах время, айдишник и данные

→ `{"cmd": "didReceiveFromPeer", "args": { "peerID": "iPhone Masala", "data": "text message (?)" }}`

← `{"result": "ok"}`

<hr/>

Опционально добавить нужны технические параметры типа версии jsonrpc, sequence id, версия аппки.

Добавить в запрос:

→ `{"jsonrpc": "2.0", "id": 3, "appVersion": "1.0", "appBuildNo": "123"}`

В ответ:

← `{"jsonrpc": "2.0", "id": 3}`
